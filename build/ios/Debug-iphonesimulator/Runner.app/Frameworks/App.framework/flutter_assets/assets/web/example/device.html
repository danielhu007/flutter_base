<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>plus.device æµ‹è¯•</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 0; padding: 16px; background: #f8f8f8; }
    button { display: block; width: 100%; max-width: 320px; margin: 12px auto; padding: 16px 0; font-size: 18px; border-radius: 8px; border: none; background: #ef6a38; color: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.04); cursor: pointer; transition: background 0.2s; }
    button:active { background: #d95c28; }
  </style>
</head>
<body>
  <h1>plus.device æµ‹è¯•</h1>
  <button onclick="testModel()">è·å– model</button>
  <button onclick="testVendor()">è·å– vendor</button>
  <button onclick="testUuid()">è·å– uuid</button>
  <button onclick="testGetInfo()">getInfo</button>
  <button onclick="testBeep()">beep</button>
  <button onclick="testDial()">dial</button>
  <button onclick="testVibrate()">vibrate</button>
  <button onclick="testGetCurrentType()">è·å–ç½‘ç»œç±»å‹</button>
  <button onclick="testIsSetProxy()">æ£€æŸ¥ä»£ç†è®¾ç½®</button>
  <button onclick="testOSInfo()">è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯</button>
  <script>
    let plusReady = false;
    
    function checkPlusReady() {
      if (!plusReady) {
        alert('Plusç¯å¢ƒæœªå°±ç»ªï¼Œè¯·ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½');
        return false;
      }
      return true;
    }
    
    function testModel() {
      if (!checkPlusReady()) return;
      try {
        // plus.device.model åº”è¯¥æ˜¯åŒæ­¥å±æ€§ï¼Œä¸æ˜¯Promise
        const model = plus.device.model;
        alert('model: ' + model);
      } catch (e) {
        alert('è·å–modelå¤±è´¥: ' + e.message);
      }
    }
    
    function testVendor() {
      if (!checkPlusReady()) return;
      try {
        const vendor = plus.device.vendor;
        alert('vendor: ' + vendor);
      } catch (e) {
        alert('è·å–vendorå¤±è´¥: ' + e.message);
      }
    }
    
    function testUuid() {
      if (!checkPlusReady()) return;
      try {
        const uuid = plus.device.uuid;
        alert('uuid: ' + uuid);
      } catch (e) {
        alert('è·å–uuidå¤±è´¥: ' + e.message);
      }
    }
    
    function testGetInfo() {
      if (!checkPlusReady()) return;
      try {
        plus.device.getInfo(function(info) {
          alert('getInfo: ' + JSON.stringify(info, null, 2));
        });
      } catch (e) {
        alert('è°ƒç”¨getInfoå¤±è´¥: ' + e.message);
      }
    }
    
    function testBeep() {
      if (!checkPlusReady()) return;
      try {
        plus.device.beep(1);
        alert('å·²è°ƒç”¨ beep');
      } catch (e) {
        alert('è°ƒç”¨beepå¤±è´¥: ' + e.message);
      }
    }
    
    function testDial() {
      if (!checkPlusReady()) return;
      try {
        var number = prompt('è¯·è¾“å…¥è¦æ‹¨æ‰“çš„å·ç ', '10086');
        if (number) {
          plus.device.dial(number, false);
        }
      } catch (e) {
        alert('è°ƒç”¨dialå¤±è´¥: ' + e.message);
      }
    }
    
    function testVibrate() {
      if (!checkPlusReady()) return;
      try {
        plus.device.vibrate(500);
        alert('å·²è°ƒç”¨ vibrate');
      } catch (e) {
        alert('è°ƒç”¨vibrateå¤±è´¥: ' + e.message);
      }
    }
    
    function testGetCurrentType() {
      if (!checkPlusReady()) return;
      try {
        plus.networkinfo.getCurrentType().then(function(type) {
          let typeStr = 'æœªçŸ¥';
          switch(type) {
            case 0: typeStr = 'æœªçŸ¥'; break;
            case 1: typeStr = 'æ— ç½‘ç»œ'; break;
            case 2: typeStr = 'æœ‰çº¿ç½‘ç»œ'; break;
            case 3: typeStr = 'Wi-Fi'; break;
            case 4: typeStr = '2G'; break;
            case 5: typeStr = '3G'; break;
            case 6: typeStr = '4G'; break;
            case 7: typeStr = '5G'; break;
          }
          alert('å½“å‰ç½‘ç»œç±»å‹: ' + typeStr + ' (' + type + ')');
        });
      } catch (e) {
        alert('è·å–ç½‘ç»œç±»å‹å¤±è´¥: ' + e.message);
      }
    }
    
    function testIsSetProxy() {
      if (!checkPlusReady()) return;
      try {
        plus.networkinfo.isSetProxy().then(function(isSet) {
          alert('ä»£ç†è®¾ç½®: ' + (isSet ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'));
        });
      } catch (e) {
        alert('æ£€æŸ¥ä»£ç†è®¾ç½®å¤±è´¥: ' + e.message);
      }
    }
    
    function testOSInfo() {
      if (!checkPlusReady()) return;
      try {
        const osInfo = {
          language: plus.os.language,
          name: plus.os.name,
          vendor: plus.os.vendor,
          version: plus.os.version
        };
        alert('æ“ä½œç³»ç»Ÿä¿¡æ¯: ' + JSON.stringify(osInfo, null, 2));
      } catch (e) {
        alert('è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯å¤±è´¥: ' + e.message);
      }
    }
    
    // ç­‰å¾…plusreadyäº‹ä»¶
    document.addEventListener('plusready', function() {
      console.log('Plusç¯å¢ƒå·²å°±ç»ª');
      plusReady = true;
      
      // æ˜¾ç¤ºplusç¯å¢ƒçŠ¶æ€
      const statusDiv = document.createElement('div');
      statusDiv.style.cssText = 'background: #4CAF50; color: white; padding: 10px; margin: 10px 0; border-radius: 4px;';
      statusDiv.innerHTML = 'âœ… Plusç¯å¢ƒå·²å°±ç»ª';
      document.body.appendChild(statusDiv);
      
      // æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯
      setTimeout(function() {
        const infoDiv = document.createElement('div');
        infoDiv.style.cssText = 'background: #2196F3; color: white; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace;';
        
        try {
          const deviceInfo = {
            model: plus.device.model,
            vendor: plus.device.vendor,
            uuid: plus.device.uuid,
            imei: plus.device.imei,
            imsi: plus.device.imsi
          };
          infoDiv.innerHTML = 'ğŸ“± è®¾å¤‡ä¿¡æ¯: ' + JSON.stringify(deviceInfo, null, 2);
          
          // æ·»åŠ ç½‘ç»œä¿¡æ¯æ˜¾ç¤º
          setTimeout(function() {
            const networkInfoDiv = document.createElement('div');
            networkInfoDiv.style.cssText = 'background: #9C27B0; color: white; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace;';
            
            plus.networkinfo.getCurrentType().then(function(type) {
              let typeStr = 'æœªçŸ¥';
              switch(type) {
                case 0: typeStr = 'æœªçŸ¥'; break;
                case 1: typeStr = 'æ— ç½‘ç»œ'; break;
                case 2: typeStr = 'æœ‰çº¿ç½‘ç»œ'; break;
                case 3: typeStr = 'Wi-Fi'; break;
                case 4: typeStr = '2G'; break;
                case 5: typeStr = '3G'; break;
                case 6: typeStr = '4G'; break;
                case 7: typeStr = '5G'; break;
              }
              
              plus.networkinfo.isSetProxy().then(function(isSet) {
                const networkInfo = {
                  connectionType: typeStr,
                  connectionTypeCode: type,
                  proxySet: isSet
                };
                networkInfoDiv.innerHTML = 'ğŸŒ ç½‘ç»œä¿¡æ¯: ' + JSON.stringify(networkInfo, null, 2);
              });
            }).catch(function(e) {
              networkInfoDiv.innerHTML = 'âŒ è·å–ç½‘ç»œä¿¡æ¯å¤±è´¥: ' + e.message;
            });
            
            document.body.appendChild(networkInfoDiv);
          }, 500);
          
          // æ·»åŠ æ“ä½œç³»ç»Ÿä¿¡æ¯æ˜¾ç¤º
          setTimeout(function() {
            const osInfoDiv = document.createElement('div');
            osInfoDiv.style.cssText = 'background: #FF9800; color: white; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace;';
            
            try {
              const osInfo = {
                language: plus.os.language,
                name: plus.os.name,
                vendor: plus.os.vendor,
                version: plus.os.version
              };
              osInfoDiv.innerHTML = 'ğŸ–¥ï¸ æ“ä½œç³»ç»Ÿä¿¡æ¯: ' + JSON.stringify(osInfo, null, 2);
            } catch (e) {
              osInfoDiv.innerHTML = 'âŒ è·å–æ“ä½œç³»ç»Ÿä¿¡æ¯å¤±è´¥: ' + e.message;
            }
            
            document.body.appendChild(osInfoDiv);
          }, 1000);
          
        } catch (e) {
          infoDiv.innerHTML = 'âŒ è·å–è®¾å¤‡ä¿¡æ¯å¤±è´¥: ' + e.message;
        }
        
        document.body.appendChild(infoDiv);
      }, 1000);
    });
    
    // å¦‚æœpluså·²ç»å­˜åœ¨ï¼Œç›´æ¥æ ‡è®°ä¸ºå°±ç»ª
    if (window.plus) {
      plusReady = true;
      document.addEventListener('DOMContentLoaded', function() {
        const statusDiv = document.createElement('div');
        statusDiv.style.cssText = 'background: #4CAF50; color: white; padding: 10px; margin: 10px 0; border-radius: 4px;';
        statusDiv.innerHTML = 'âœ… Plusç¯å¢ƒå·²å°±ç»ª (é¢„åŠ è½½)';
        document.body.appendChild(statusDiv);
      });
    }
    
    // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥plusç¯å¢ƒ
    window.addEventListener('load', function() {
      console.log('é¡µé¢åŠ è½½å®Œæˆ');
      setTimeout(function() {
        if (!plusReady && !window.plus) {
          const errorDiv = document.createElement('div');
          errorDiv.style.cssText = 'background: #f44336; color: white; padding: 10px; margin: 10px 0; border-radius: 4px;';
          errorDiv.innerHTML = 'âŒ Plusç¯å¢ƒæœªåŠ è½½ï¼Œè¯·æ£€æŸ¥WebViewé…ç½®';
          document.body.appendChild(errorDiv);
        }
      }, 2000);
    });
  </script>
</body>
</html> 